
@using BlazorAppExcel.Interfaces
@using BlazorAppExcel.Models

@inject ISessionSingletonService session
@inject NavigationManager NavigationManager;

@page "/design/tables"

<DataGrid Items="@TableList">
    <Columns>
        <TemplateColumn CellClass="d-flex justify-end">
            <CellTemplate>
                <Stack Row>
                   
                    <Button Size="@Size.Small" Variant="@Variant.Filled" Color="@Color.Primary" OnClick="@(()=>ItemSelection(@context.Item))">@context.Item.Name</Button>
                </Stack>
            </CellTemplate>
        </TemplateColumn>
        <PropertyColumn Property="x => x.Name" Title="Name" />
        <PropertyColumn Property="x => x.FileName" Title="File Name" />
        <PropertyColumn Property="x => x.DateCreation" Title="Date Creation"  />
        <PropertyColumn Property="x => x.Columns.Count" Title="Columns" />
        <PropertyColumn Property="x => x.Rows.Count" Title="Rows" />
    </Columns>
</DataGrid>
    @code {
    private IEnumerable<Models.TableExcel> TableList = new List<Models.TableExcel>();

    protected override async Task OnInitializedAsync()
    {
        TableList = this.session.User.TablesToList();
    }

    protected void ItemSelection(TableExcel table)
    {
        NavigationManager.NavigateTo($"design/columns/{table.Id}");
    }
}
