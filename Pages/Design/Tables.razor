
@using BlazorAppExcel.Interfaces
@using BlazorAppExcel.Models

@inject ISessionSingletonService session
@inject NavigationManager NavigationManager;

@page "/design/tables"

<FluentDataGrid Items="@TableList">
   
        <TemplateColumn>
            <FluentButton OnClick="@(()=>ItemSelection(@context))">@context.Name</FluentButton>
        </TemplateColumn>
        <PropertyColumn Property="@(x => x.Name)" Title="Name" />
        <PropertyColumn Property="@(x => x.FileName)" Title="File Name" />
        <PropertyColumn Property="@(x => x.DateCreation)" Title="Date Creation" />
        <PropertyColumn Property="@(x => x.Columns.Count)" Title="Columns" />
        <PropertyColumn Property="@(x => x.Rows.Count)" Title="Rows" />

</FluentDataGrid>

 @code {
    private IQueryable<Models.TableExcel> TableList = null;

    protected override async Task OnInitializedAsync()
    {
        TableList = this.session.User.TablesToList().AsQueryable();
    }

    protected void ItemSelection(TableExcel table)
    {
        NavigationManager.NavigateTo($"design/columns/{table.Id}");
    }
}
