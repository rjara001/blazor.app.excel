@using BlazorAppExcel.Interfaces
@using Blazored.LocalStorage
@using Models

@inject IExcelService excelService
@inject IUserSingletonService userServices;
@inject NavigationManager NavigationManager;

<MudNavMenu>
    <MudNavLink Href="/" Match="NavLinkMatch.All">Dashboard</MudNavLink>
    <MudNavLink Href="/excel" Match="NavLinkMatch.Prefix">Excel</MudNavLink>
    <MudNavLink Href="/about"  Match="NavLinkMatch.Prefix">About</MudNavLink>
</MudNavMenu>

@code {
    private bool collapseNavMenu = true;

    private string? NavMenuCssClass => collapseNavMenu ? "collapse1" : null;

    private IList<TableExcel> tables = new List<TableExcel>();

    public void HandleNavLinkClick(TableExcel table)
    {
        this.userServices.User.TableActive = table;

        NavigationManager.NavigateTo($"app/{table.CodeName}");
        // Href =@($"app/{@table.CodeName}"
    }

    protected override async Task OnInitializedAsync()
    {
        tables = await excelService.getTableExcels("user");

        this.userServices.User = new User(tables.ToDictionary(obj => obj.Name));

    }

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }
}
